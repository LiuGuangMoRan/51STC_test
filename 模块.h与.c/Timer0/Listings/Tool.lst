C51 COMPILER V9.54   TOOL                                                                  02/28/2023 11:14:22 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TOOL
OBJECT MODULE PLACED IN .\Objects\Tool.obj
COMPILER INVOKED BY: D:\Keil5\Keil5 C51\C51\BIN\C51.EXE Tool.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listi
                    -ngs\Tool.lst) TABS(2) OBJECT(.\Objects\Tool.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          sbit LCD_RS = P2^6;       //  RS: æ•°æ®/æŒ‡ä»¤ç«¯ï¼Œ1ä¸ºæ•°æ®ï¼Œ0ä¸ºæŒ‡ä»¤
   4          sbit LCD_RW = P2^5;       //  RW: è¯»å†™/å†™ç«¯ï¼Œ1ä¸ºè¯»ï¼Œ0ä¸ºå†™
   5          sbit LCD_E  = P2^7;       //  Eï¼š  ä½¿1æ•°æ®æœ‰æ•ˆï¼Œä¸‹é™æ²¿æ‰§è¡Œå‘½ä»¤
   6          
   7          #define LCD_DataPort P0   ////æ•°æ®è¾“å…¥ç«¯ï¼Œä¼ 16è¿›åˆ¶æ•°ï¼Œ0000 0000 
   8          
   9          /** 
  10            * @brief  1.å»¶è¿Ÿå‡½æ•°
  11            * @param  xmsä¸ºæ‰€éœ€çš„å»¶è¿Ÿæ—¶é—´(å•ä½ï¼šms)
  12            * @retval Delay(xms)ä½œç”¨äºç­‰å¾…æˆ–æ¶ˆé™¤æ—¶é—´å¯¹ç¨‹åºçš„å½±å“,æ ¹æ®å•ç‰‡æœºæ™¶æŒ¯é¢‘ç‡è®¡ç®—å¾
             -—æ¥
  13            */
  14          
  15          void Delay(unsigned int xms)
  16          {
  17   1        unsigned char i, j;
  18   1        while(xms--)
  19   1        {
  20   2          i = 2;
  21   2          j = 239;
  22   2          do
  23   2          {
  24   3            while (--j);
  25   3          } while (--i);
  26   2        }
  27   1      }
  28          
  29          
  30          /** 
  31            * @brief  2.æ¨¡å—åŒ–æ•°ç ç®¡æ“ä½œ
  32            * @param  Numberæ§åˆ¶æ•°ç ç®¡æ˜¾ç¤ºçš„æ•°å­—(å‡½æ•°NixieTable)ï¼ŒLocationé€‰æ‹©å¯¹åº”çš„æ•°ç ç®¡ï¼ŒNu
             -mberä½œç”¨æ•ˆæœ(Nixie)
  33            * @retval NixieTable(Number)æ§åˆ¶æ•°ç ç®¡æ˜¾ç¤ºæ•°å€¼,Nixie(Location,Number)æ§åˆ¶é€‰å®šæ•°ç ç®¡
  34            * @explain P0ç«¯æ§åˆ¶æ˜¾ç¤ºå¯¹åº”æ•°å€¼ï¼ŒP2_2 ~ P2_4æ§åˆ¶æ•°ç ç®¡çš„é€‰æ‹©ï¼Œé€šè¿‡3ä¸ªç«¯å£è¾“å…¥ä
             -ºŒè¿›åˆ¶ä»£ç ï¼Œç”¨è¯‘ç å™¨è¾“å‡º8ç§çŠ¶æ€      
  35            */
  36          
  37          //2.1æ§åˆ¶æ•°ç ç®¡æ˜¾ç¤ºæ•°å€¼
  38          void NixieTable(unsigned char Number)
  39          {
  40   1        switch(Number)
  41   1        {
  42   2          case 0:P0=0x3F;break;
  43   2          case 1:P0=0x06;break;
  44   2          case 2:P0=0x5B;break;
  45   2          case 3:P0=0x4F;break;
  46   2          case 4:P0=0x66;break;
  47   2          case 5:P0=0x6D;break;
  48   2          case 6:P0=0x7D;break;
  49   2          case 7:P0=0x07;break;
  50   2          case 8:P0=0x7F;break;
  51   2          case 9:P0=0x6F;break;
C51 COMPILER V9.54   TOOL                                                                  02/28/2023 11:14:22 PAGE 2   

  52   2        }
  53   1      }
  54          
  55          //2.1æ§åˆ¶é€‰å®šæ•°ç ç®¡
  56          void Nixie(unsigned char Location,unsigned char Number)
  57          {
  58   1         switch(Location)
  59   1        {
  60   2          case 1: P2_4=1;P2_3=1;P2_2=1;break;
  61   2          case 2: P2_4=1;P2_3=1;P2_2=0;break;
  62   2          case 3: P2_4=1;P2_3=0;P2_2=1;break;
  63   2          case 4: P2_4=1;P2_3=0;P2_2=0;break;
  64   2          case 5: P2_4=0;P2_3=1;P2_2=1;break;
  65   2          case 6: P2_4=0;P2_3=1;P2_2=0;break;
  66   2          case 7: P2_4=0;P2_3=0;P2_2=1;break;
  67   2          case 8: P2_4=0;P2_3=0;P2_2=0;break;
  68   2        }
  69   1        NixieTable(Number);
  70   1      }
  71            
  72          
  73          /** 
  74            * @brief  3.LCD1602æ¶²æ™¶æ˜¾ç¤ºå±æ¨¡å—åŒ–
  75            * @include 3.1 å†™å…¥åŠŸèƒ½æŒ‡ä»¤ï¼ŒLCD1602å™¨ä»¶æœ‰æŒ‡ä»¤é›†           3.2å†™å…¥æ•°æ®
  76            *          3.3å¯¹LCDè¿›è¡Œåˆå§‹åŒ–                               3.4é€‰å®šå±å¹•ä½ç½®
  77            *          3.6å±•ç¤ºå­—ç¬¦ä¸²                                   3.7å±•ç¤ºæ— ç¬¦å·çš„æ•°å­— 
  78            *          3.8.å±•ç¤ºç¬¦å·çš„æ•°å­—
  79            */
  80          
  81          /** 
  82            * @brief   3.1å†™å…¥åŠŸèƒ½æŒ‡ä»¤ï¼ŒLCD1602å™¨ä»¶æœ‰æŒ‡ä»¤é›†
  83            * @param   Commandä¸ºå†™å…¥æŒ‡å®šå†…å®¹
  84            * @retval  LCD_WriteCommand(Command)å†™å…¥åŠŸèƒ½æŒ‡ä»¤ï¼Œå¯¹LCD1602è¿›è¡Œåˆå§‹åŒ–  
  85            */
  86          
  87          void LCD_WriteCommand(unsigned char Command)
  88          { 
  89   1        //æ ¹æ®å†™å…¥æ•°æ®/æŒ‡ä»¤(æ—¶åºç»“æ„)
  90   1        
  91   1        LCD_RS = 0;               // 0ä¸ºæŒ‡ä»¤
  92   1        LCD_RW = 0;               // 0ä¸ºå†™å…¥
  93   1        LCD_DataPort = Command;         // å†™å…¥æŒ‡å®šå†…å®¹
  94   1        LCD_E  = 1;               // ä¸‹é™æ²¿æ‰§è¡Œå‘½ä»¤
  95   1        Delay(1);               
  96   1        LCD_E  = 0;
  97   1        Delay(1);
  98   1      }
  99          
 100          
 101          /** 
 102            * @brief   //3.2å†™å…¥æ•°æ®
 103            * @param   Dataä¸ºå†™å…¥æŒ‡å®šå†…å®¹
 104            * @retval  LCD_WriteData(Data)å†™å…¥æ•°æ®å†…å®¹
 105            */
 106          
 107          void LCD_WriteData(unsigned char Data)
 108          {
 109   1        LCD_RS = 1;               // 1ä¸ºæŒ‡ä»¤
 110   1        LCD_RW = 0;               // 0ä¸ºå†™å…¥
 111   1        LCD_DataPort = Data;          // å†™å…¥æŒ‡å®šå†…å®¹
 112   1        LCD_E  = 1;               // ä¸‹é™æ²¿æ‰§è¡Œå‘½?
 113   1        Delay(1);               // æ‰§è¡ŒæŒ‡ä»¤çš„æ—¶é—´ä¸ºmsçº§
C51 COMPILER V9.54   TOOL                                                                  02/28/2023 11:14:22 PAGE 3   

 114   1        LCD_E  = 0;               // è€ŒEçš„æ‰§è¡Œæ—¶é—´ä¸ºnsçº§ ,æ‰€ä»¥è¦å»¶è¿Ÿä»¥é˜²Eæ‰§è¡Œè¿‡å¿«
 115   1        Delay(1);               // å‰é¢çš„Delay1mséƒ½ä¸èƒ½å°‘ï¼Œå°‘äº†å°±é€šä¿¡ä¸äº†
 116   1      }
 117          
 118          /** 
 119            * @brief   //3.3å¯¹LCDè¿›è¡Œåˆå§‹åŒ–
 120            * @param   æ— 
 121            * @retval  LCD_Init(void)å¯¹LCDé€‰å®šæ‰€éœ€åŠŸèƒ½ä¸€äº›æŒ‡ä»¤
 122            */
 123          
 124          void LCD_Init(void)
 125          {
 126   1        //é€‰å®šæ‰€éœ€åŠŸèƒ½
 127   1        LCD_WriteCommand(0x38);
 128   1        LCD_WriteCommand(0x0C);
 129   1        LCD_WriteCommand(0x06);
 130   1        LCD_WriteCommand(0x01);
 131   1      }
 132          
 133          /** 
 134            * @brief   //3.4é€‰å®šå±å¹•ä½ç½®
 135            * @param   Lineæ˜¯é€‰å®šLCDçš„è¡Œ  Columnæ˜¯é€‰å®šLCDåˆ—çš„
 136            * @retval  LCD_Pleace(Line,Column)é€‰å®šLCDå±å¹•ä½ç½®
 137            */
 138          
 139          void LCD_Pleace(unsigned char Line,unsigned char Column)
 140          {
 141   1        if(Line == 1)
 142   1        {
 143   2          LCD_WriteCommand(0x80|(Column-1));      //è®¾ç½®æ•°æ®ä½ç½®(å…‰æ ‡ä½ç½®)
 144   2        }
 145   1        else
 146   1        {
 147   2          LCD_WriteCommand(0x80|(Column-1)+0x40);
 148   2        }
 149   1      }
 150          
 151          /** 
 152            * @brief   //3.5å±•ç¤ºå•å­—èŠ‚
 153            */
 154          
 155          void LCD_ShowChar(unsigned char Line,unsigned char Column,unsigned char Char)
 156          {
 157   1        LCD_Pleace(Line,Column);
 158   1        LCD_WriteData(Char);
 159   1      }
 160          
 161          /** 
 162            * @brief   //3.6å±•ç¤ºå­—ç¬¦ä¸²
 163            */
 164           
 165          void LCD_ShowString(unsigned char Line,unsigned char Column,unsigned char*String)
 166          {
 167   1        unsigned char i;
 168   1        LCD_Pleace(Line,Column);
 169   1        for(i=0;String[i]!='\0';i++)
 170   1        {
 171   2          LCD_WriteData(String[i]);
 172   2        }
 173   1      }
 174          
 175          
C51 COMPILER V9.54   TOOL                                                                  02/28/2023 11:14:22 PAGE 4   

 176          /** 
 177            * @brief   //3.6Powå¹³æ–¹è¿ç®—(åŠŸèƒ½å‡½æ•°)
 178            */
 179          
 180          int LCD_Pow(int X,int Y)
 181          {
 182   1        unsigned char i;
 183   1        int Result = 1;
 184   1        for(i=0;i<Y;i++)
 185   1        {
 186   2          Result*=X;
 187   2        }
 188   1        return Result;
 189   1      }
 190          
 191          /** 
 192            * @brief  3.7å±•ç¤ºæ— ç¬¦å·çš„æ•°å­—
 193            */
 194          
 195          void LCD_ShowNum(unsigned char Line,unsigned Column,unsigned int Number,unsigned char Length)
 196          {
 197   1        unsigned char i;
 198   1        LCD_Pleace(Line,Column);
 199   1        for(i=Length;i>0;i--)
 200   1        {
 201   2          LCD_WriteData(Number/LCD_Pow(10,i-1)%10+'0'); //å¾—åˆ°æ•´æ•°çš„æ¯ä¸ªæ•°å­—
 202   2        }
 203   1      }
 204          
 205          /** 
 206            * @brief  3.8.å±•ç¤ºç¬¦å·çš„æ•°
 207            */
 208          
 209          void LCD_ShowSignedNum(unsigned char Line,unsigned char Column,int Number,unsigned char Length)
 210          {
 211   1        unsigned char i;
 212   1        int Number1;
 213   1        LCD_Pleace(Line,Column);
 214   1        if(Number>=0)
 215   1        {
 216   2          LCD_WriteData('+');
 217   2          Number1=Number;
 218   2        }
 219   1        else
 220   1        {
 221   2          LCD_WriteData('-');
 222   2          Number1=-Number;
 223   2        }
 224   1        for(i=Length;i>0;i--)
 225   1        {
 226   2          //è¿™é‡Œè®¡ç®—çš„åè¿›åˆ¶æ•°ï¼Œè¦å±•ç¤ºæ•°å­—è¦å¯¹åº”è¡¨çš„æ•°å€¼ï¼Œæ‰€ä»¥è¦åŠ '0'
 227   2          LCD_WriteData(Number1/LCD_Pow(10,i-1)%10+'0');  //å¾—åˆ°æ•´æ•°çš„æ¯ä¸ªæ•°å­—
 228   2        }
 229   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    500    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      21
C51 COMPILER V9.54   TOOL                                                                  02/28/2023 11:14:22 PAGE 5   

   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
